\documentclass[main.tex]{subfiles}
\newcommand{\mr}[1]{\mathrm{#1}}
\newcommand{\mc}[1]{\mathcal{#1}}

\begin{document}
\section{Osnovno o valićima. Haarov sistem}\label{sec:val1}
Nakon Fourierove transformacije, javlja se ideja funkcije dekomponirati
s obzirom na neku drugu familiju funkcija. Unatoč brojnim lijepim svojstvima
Fourierove transformacije koja smo vidjeli u prošlom odjeljku, možemo naći i dvije
mane. Prvo: da daje globalno ponašanje funkcije u frekvencijskoj dimenziji, ali
nije osjetljiva na lokalne fenomene. Drugo, da iako su funkcije
\( x \mapsto e^{i\xi x} \) jednostavne u frekvencijskoj dimenziji,
u vremenskoj nemaju kompaktan nosač, a nisu niti integrabilne (osim u smislu temperiranih distribucija).
To nas može motivirati da ih zamijenimo funkcijama koje su po tom pitanju bolje.
Pokazuje se da je tu uvijek nužan kompromis, tj.\ inzistiranjem na novim svojstvima
izgubit ćemo neka lijepa svojstva koja smo prije imali.

Jedna takva alternativna familija su \emph{valići}.
Počnimo od neke funkcije \( \psi \colon \R \to \C \)
koju zovemo \emph{matični valić}.
Zatim, za \( a \in \R \setminus \left\{ 0 \right\} \)
i \( b \in \R \) definiramo
\begin{equation}
	\psi_{a,b}(x) = \abs a^{-1/2} \psi \left( \frac {x-b}a \right), \quad x \in \R.
\end{equation}
Primijetimo da s \( b \) pomičemo početni \( \psi \) po \( x \)-osi, dok smanjenjem \( a \)
sužavamo \( \psi \) i povećavamo amplitudu. Riječ je redom o translaciji i dilataciji,
pa u oznakama komentara~\ref{kom:four-kovac} možemo pisati i
\( \psi_{a,b} = \mr D_a \mr T_b \psi \). Ta dva operatora onda generiraju
\emph{sistem} funkcija pa je pravilnije govoriti o valićima kao sistemu funkcija,
dok se za neki konkretni matični valić \( \psi \) dobivamo \emph{familiju} \( \left\{ \psi_{a,b} \right\}_{a\neq 0, b \in \R} \).

Pitanje je kakva svojstva mora imati \( \psi \). Zahtjevi se razlikuju ovisno o primjeni,
ali vjerojatno najčešći i najosnovniji zahtjev je
\begin{equation}\label{eq:psi-dopustiv}
	\int_\R \psi(x) \D x = 0.
\end{equation}
Matični valić \( \psi \) koji zadovoljava~\eqref{eq:psi-dopustiv} ponekad se zove \emph{dopustiv}.
Objasnimo taj uvjet. Uzmimo svakako \( \psi \in \L^2(\R) \) tako da ima
Fourierovu transformaciju. Definiramo \emph{neprekidnu valićnu transformaciju} \( {\mc T^{\mr{wav}}} \) s
\begin{equation}\label{eq:cwt}
	(\mc T^{\mr{wav}} f)(a,b) = \skp f{\psi_{a,b}} =
	\int_\R f(x) \abs a^{-1/2} \ol{\psi\left( \frac{x-b}a \right)} \D x, \quad f \in \L^2(\R).
\end{equation}
Riječ je o valićnom analogonu formule~\eqref{eq:four}.
U ovom radu se nećemo baviti neprekidnom valićnom transformacijom, pa ćemo
samo navesti i analogon formule inverzije~\eqref{eq:four-inverzija}:
\begin{equation}\label{eq:wav-inverzija}
	f = C_\psi^{-1} \int_\R \int_\R
	(\mc T^{\mr{wav}} f)(a,b) \psi_{a,b} \frac{\D a \D b}{a^2}, \quad f \in \L^2(\R),
\end{equation}
pri čemu je \( C_\psi \) konstanta koja mora biti konačna:
\begin{equation}\label{eq:cpsikon}
	C_\psi = 2\pi \int_\R \abs \xi ^{-1} \abs{\wh \psi(\xi)}^2 \D \xi < \infty.
\end{equation}
Ako je \( \psi \in \L^1(\R) \) je \( \wh \psi \)
neprekidan pa je jedini način da vrijedi~\eqref{eq:cpsikon}
da je \( \wh \psi (0)=0 \), a to je
upravo~\eqref{eq:psi-dopustiv} po definiciji~\ref{def:four}.
S druge strane, može se pokazati (v.~\cite[\textsection 2.4]{daub}) da ako vrijedi~\eqref{eq:psi-dopustiv}
i jači uvjet od integrabilnosti
\begin{equation}\label{eq:psijaceodl1}
	\int_\R \left( 1 + \abs x \right)^\alpha \psi(x) \D x < \infty
\end{equation}
za neki \( \alpha > 0 \) da slijedi~\eqref{eq:cpsikon}.
Uvjeti~\eqref{eq:cpsikon} i~\eqref{eq:psi-dopustiv} su u
praksi ekvivalentni jer će se zahtjevi na \( \psi \)
ipak biti dosta jači nego~\eqref{eq:psijaceodl1}.

Ne moramo \( a \) i \( b \) uzimati neprekidno, već je moguće
razmatrati samo diskretnu rešetku. Za \( j, k \in \Z \) definirajmo
\begin{equation}\label{eq:psijk}
	\psi_{j, k}(x) = 2^{-j/2} \psi(2^{-j}x-k), \quad x \in \R,
\end{equation}
tj.\ \( \psi_{j,k} = \mr D_{2^j}\mr T_k \psi \). Familija
\( \left\{ \psi_{j,k} \right\}_{j,k\in\Z} \) je prebrojiva, a
idealno bi bilo kad bi bila ortonormirana baza prostora \( \L^2(\R) \).
Nije \emph{a priori} jasno da je to ikada moguće, ali
pokazat ćemo u drugom dijelu ovog i sljedećem odjeljku da
zapravo postoji puno takvih ortonormiranih baza.
To je prednost u odnosu na Fourierovu transformaciju jer
\( x \mapsto e^{ikx} \) za \( k \in \Z \) razapinju
samo periodičke funkcije. Odsad se bavimo familijama danima s~\eqref{eq:psijk}.

Prije nego damo primjer ortonormirane valićne baze,
vratimo se na pitanje svojstava \( \psi \).
Tipična poželjna svojstva koja se traže su sljedeća:
\begin{itemize}
	\item glatkoća, ili, blisko tome, nestajući momenti,
	\item kompaktan nosač u vremenskoj ili frekvencijskoj dimenziji (tj.\ kompaktnost od \( \supp \psi \) i \( \supp \wh \psi \) redom),
	\item kada nemamo kompaktnost da \( \psi \), neke derivacije od \( \psi \) ili \( \wh \psi \) padaju nekom brzinom,
	\item da je \( \psi  \) parna funkcija (simetrična; ekvivalentno je da je \( \wh \psi \) realna) ili da je
	      realan; alternativno, u nekim primjenama korisni su kompleksni valići.
\end{itemize}
Sljedeći teorem (v.~\cite[\textsection 9]{daub}) pokazuje da su uz vrlo razumne zahtjeve ortonormirane baze na
\( \L^2(\R) \) ujedno bezuvjetne baze na drugim funkcijskim prostorima.

\newcommand{\fusnota}{\footnote{oznaka \( \lesssim \) u \( f(x) \lesssim g(x) \) znači \( f(x) \le Cg(x) \) za neku konstantu \( C > 0 \) neovisnu o \( x \)}}
\begin{teorem} \label{bezbazaLp}
	Ako je \( \psi \) takav da je \( \left\{ \psi_{j,k} \st j,k \in \Z \right\} \) iz~\eqref{eq:psijk} ortonormirana bazu na \( \L^2(\R) \) i ako dodatno vrijede uvjeti\fusnota
	\begin{equation} \label{dovuvjetipsi}
		\psi \in \mr C^1(\R) \qquad \mathrm i \qquad \abs{\psi(x)}, \abs{\psi'(x)} \lesssim (1 + \abs x)^{-1-\varepsilon},
	\end{equation}
	tada je \( \left\{ \psi_{j,k} \st j,k \in \mathbb Z \right\} \) također bezuvjetna baza na \( \L^p(\R) \), \( 1 < p < \infty \).
\end{teorem}
Zapravo, isti uvjeti dovoljni su da \( \psi_{j,k} \) čine ortonormiranu bazu \emph{Hardy--Littlewoodovog}
prostora kojeg ovdje nećemo definirati, a uz nešto jače uvjete i drugih funkcijskih prostora kao što
su npr.\ \emph{Soboljevljevi prostori}.

Poželjna svojstva imaju svoje granice. Najpoznatiji
primjer je \emph{princip neodređenosti} koji govori
da nije moguće (osim u trivijalnom slučaju)
postići da funkcija ima kompaktan nosač i u
vremenskoj i u frekvencijskoj dimenziji (v.~\cite[theorem~4]{kovac-wroclaw}).

\begin{teorem}
	Ako je \( f \in \L^2(\R) \) takva da su i \( \supp f \)
	i \( \supp \wh f \) kompaktni, tada je \( f=0 \)~g.s.
\end{teorem}
Sljedeći teorem (v.~\cite{daub2}) uvodi Daubechiesjine valiće, ali i sugerira ograničenje
da ne postoje valići klase \( \mr C^\infty \) kompaktnog nosača
koji čine ortonormiranu bazu na \( \L^2(\R) \).
\begin{teorem}
	Za svaki \( k \in \N \) postoji \( \psi \in \mr C_\mrc ^k(\R) \)
	takav da je s~\eqref{eq:psijk} dana
	ortonormirana baza na \( \L^2(\R) \).
\end{teorem}
Poznato je i što smo rekli, da tvrdnja ne vrijedi za \( k = \infty \).
Meyerovi valići koje uvodimo u odjeljku~\ref{sec:meyer}
nalazit će se taman izvan ovih ograničenja.

\bigskip
\newcommand{\psh}{\psi^{\mathrm{Haar}}}
U ostatku odjeljka cilj nam je dokazati da Haarovi valići čine ortonormiranu bazu
na \( \L^2(\R) \). Haarovi valići dani su matičnim valićem
\begin{equation}\label{eq:haar}
	\psi^{\mathrm{Haar}}(x) = \begin{cases}\begin{aligned}
			1,  & \quad & 0 \le x < 1/2, \\
			-1, & \quad & 1/2 \le x < 1, \\
			0,  & \quad & \text{inače}.
		\end{aligned}\end{cases}
\end{equation}
Familija generirana preko~\eqref{eq:haar} zapravo je poznata
kao ortonormirana baza na \( \L^2(\R) \) puno dulje nego što uopće postoji pojam valića.
Poznatija je kao \emph{Haarov sistem}, makar po prethodnoj diskusiji na te funkcije
doista možemo gledati kao na valiće. Ti valići nemaju lijepa svojstva (imaju
kompaktan nosač u vremenskoj dimenziji; ali u frekvencijskoj opadaju sporo;
nemaju glatkoću), ali zbog svoje jednostavnosti često igraju didaktičku ulogu.
To je slučaj i ovdje~---~poanta dokaza je motivirati temu sljedećeg odjeljka.

\begin{teorem}\label{tm:haar}
	Familija valića \( \left\{ \psh_{j,k} \st j,k \in \Z \right\} \)
	je ortonormirana baza prostora \( \L^2(\R) \).
\end{teorem}

\renewcommand{\fusnota}{\footnote{dijadski intervali
su oni iz familije \( \mathcal D = \left\{ \left[ 2^jk, 2^j(k+1) \right\rangle \st j,k\in\Z \right\} \)}}
\begin{proof}
	Normiranost lako slijedi direktnim računom. Dokažimo da su
	\( \psh_{j,k} \) i \( \psh_{j',k'} \) ortogonalni ako \( (j,k) \neq (j',k') \).
	Ako je \( j=j' \) su im nosači disjunktni. Neka je bez smanjenja općenitosti
	\( j < j' \). Nosač od
	\( \psh_{j,k} \) je, do na rub, dijadski interval\fusnota \( \left[ 2^jk,2^j(k+1) \right\rangle \)
	(to vrijedi općenito ako \( \supp \psi = \left[ 0,1 \right] \)).
	Nosač \( \supp \psh_{j',k'} \) je dijadski interval veće duljine, pa je
	\( \supp \psh_{j,k} \) cijeli sadržan ili u lijevoj ili u desnoj polovici
	od \( \supp \psh_{j',k'} \). Na tim polovicama je \( \psh_{j',k'} \) konstantan,
	pa je skalarni produkt proporcionalan sa \( \int_\R \psh_{j,k}(x) \D x = 0 \)
	zbog svojstva~\eqref{eq:psi-dopustiv}.

	Glavni dio dokaza je dokazati da Haarovi valići
	razapinju potprostor gust u \( \L^2(\R) \). Svaka \( f \in \L^2(\R) \)
	može se proizvoljno dobro aproksimirati funkcijom \( f_0 \)
	čiji je nosač \( I_{M} \coloneq \left[ -2^{M},2^{M} \right] \)
	i koja je konstantna na dijadskim intervalima
	\( I_{N,\ell} \coloneq \left[ 2^{-N}\ell, 2^{-N}(\ell+1) \right\rangle \)
	gdje je \( \ell \) takav da \( I_{N,\ell} \subseteq I_M \).
	S \( f_{0, \ell} \) označimo skalare takve da
	\begin{equation}
		f_0 = \sum_{\ell \st I_{N,\ell} \subseteq I_M} f_{0,\ell} 1_{I_{N,\ell}}
	\end{equation}
	i analogne oznake koristimo drugdje.
	Dovoljno je dokazati
	da se \( f_0 \) može proizvoljno dobro aproksimirati Haarovim valićima.

	Prikažimo \( f_0 \) u obliku \( f_0 = f_1 + \delta_1 \) gdje je
	\( f_1 \) funkcija konstantna na intervalima dvostruko veće duljine
	\( 2^{-N+1} \), a te konstante su prosjeci od \( f_0 \) na
	odgovarajućim intervalima. Drugim riječima
	\( f_{1, \ell} = \frac 12 \left( f_{0,2\ell} + f_{0,2\ell + 1} \right) \)
	za \( \ell \) takav da \( I_{N-1,\ell} \subseteq I_M \) .
	Funkcija \( \delta_1 \) je onda konstanta na intervalima iste duljine kao kod \( f_0 \)
	i štoviše
	\begin{align}
		\footnotesize
		\delta_{1, 2\ell}  & = f_{0,2\ell} - f_{1,\ell} = \frac 12 \left( f_{0,2\ell} - f_{0,2\ell + 1} \right)
		\\
		\delta_{1,2\ell+1} & = f_{0,2\ell+1} - f_{1,\ell}
		= \frac 12 \left( f_{0,2\ell+1} - f_{0,2\ell} \right) = -\delta_{1,2\ell},
	\end{align}
	za \( \ell \) takve da \( I_{N,2\ell} \subseteq I_M \).
	Time smo dobili da je \( \delta_1 \) linearna kombinacija Haarovih valića:
	\begin{equation}
		\delta_1(x) = \sum_{\ell \st I_{N,2\ell} \subseteq I_M} \delta_{1,2\ell}
		\psh\left( 2^{N_1}x-\ell \right), \quad x \in I_M.
	\end{equation}

	Postupak možemo ponavljati i dobiti funkcije \( f_2, f_3 \) itd. Ponavljanjem
	postupka ukupno \( N+M \) puta dobit ćemo funkciju \( f_{N+M} \)
	kojoj je nosač i dalje \( I_M \), a konstantna je na intervalima
	\( \left[ -2^M,0 \right] \) i \( \left[ 0,2^M \right] \)
	i tamo jednaka odgovarajućim prosjecima funkcije \( f_0 \).
	Dobiva se
	\begin{equation}
		f_0 = f_{N+M} + \sum_{k=1}^{N+M} \delta_k
		= f_{N+M} + \sum_{k=1}^{N+M} \sum_{\ell \st I_{N-k+1, 2\ell} \subseteq I_M}
		c_{-N+k, \ell} \psh_{-N+k,\ell},
	\end{equation}
	pri čemu su \( c_{-N+k,\ell} \) skalari.

	Možemo nastaviti, tako da \( f_{N+M+1} \) ima
	dvostruko veći nosač \( I_{M+1} \), pri čemu će biti
	\[ \delta^{N+M+1}(x) = \frac12 \left[ f_{N+M,0} \psh\left( 2^{-M-1}x \right) \right]
		+ \frac 12 \left[ f_{N+M,-1}\psh\left( 2^{-M-1}x + 1 \right) \right],
		\quad x \in I_{M+1}.\]
	Ponavljanjem postupka ukupno \( K \) puta dolazimo do funkcije
	\( f_{N+M+K} \) takve da
	\begin{equation}
		f_{N+M+K}(x) = \begin{cases}
			\begin{aligned}
				2^{-K}f_{N+M,-1} & , \quad  x \in  \left[ -2^{M+K}, 0 \right\rangle, \\
				2^{-K}f_{N+M,0}  & , \quad x \in \left[ 0, 2^{M+K} \right\rangle.
			\end{aligned}
		\end{cases}
	\end{equation}
	Vrijedi \begin{equation} \norm{f_{N+M+K}}_2 = \sqrt{\left[ \abs{f_{N+M,0}}^2+\abs{f_{N+M,-1}}^2 \right] 2^{M-K}} \rightarrow 0, \quad K \ub,
	\end{equation}
	što nam daje i traženu aproksimaciju
	\begin{equation}\label{eq:aproxf0}
		\sum_{k=1}^{N+M+K} \delta_k \stackrel{\L^2}{\longrightarrow} f_0, \quad K \ub.
	\end{equation}
\end{proof}

\begin{komentar}
	Rezultat~\eqref{eq:aproxf0} može se činiti paradoksalan.
	Ako za svaki \( \psi_{j,k} \) vrijedi~\eqref{eq:psi-dopustiv},
	isto vrijedi za svaku linearnu kombinaciju. Kako je onda moguće proizvoljnu
	\( f \in \L^2(\R) \) dobiti kao limes funkcija s integralom nula?
	Ključno je da aproksimacija vrijedi u \( \L^2 \)-normi,
	ali ne i u \( \L^1 \)-normi~---~niz (u \(K\)) funkcija \( f_{N+M+K} \)
	primjer je niza koji u \( \L^1(\R) \) ima (zbog konstrukcije) konstantu normu, ali u \( \L^2(\R) \)
	konvergira u \( 0 \).
\end{komentar}

\begin{komentar}\label{kom:tmhaar2}
	Definirajmo za fiksni \( j \in \Z \)
	\begin{equation}
		V_j = \left\{ f \in \L^2(\R) \st
		f \text{ konstantna na} \left[ 2^jk, 2^j(k+1) \right\rangle \text{ za sve } k \in \Z
		\right\}.
	\end{equation}
	Lako je dokazati da je \( V_j \) zatvoreni potprostor od \( \L^2(\R) \).
	Kad \( j \rightarrow -\infty \), možemo reći da prostori dopuštaju
	sve više \emph{detalja} ili sve finiju \emph{rezoluciju}.
	Istovremeno, prostori \( V_j \) su međusobno slični;
	svaki se može dobiti kao dilatacija bilo kojeg drugog.

	U dokazu teorema~\ref{tm:haar} dokazali smo
	\begin{equation}
		\olspan \left\{ \psh_{j',k} \st j' > j,\ k \in \Z \right\}
		= V_j, \quad j \in \Z.
	\end{equation}
	Očekivano, sve finiji valići razapinju sve finije potprostore.
\end{komentar}

\end{document}
